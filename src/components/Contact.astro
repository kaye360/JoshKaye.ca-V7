---
import Type from "./Type.astro";
---

<section id="contact" class="grid md:grid-cols-2 gap-8 max-width px-def">

	<div class="md:col-span-2">
		<h2>let's talk</h2>
	
		<p class="my-8">* required fields</p>
	</div>

	<form id="email-form" action="email-handler.php" method="post" data-netlify="true">
		<div class="flex flex-col gap-8">
			<label>
				<span>name*</span>
				<input type="text" name="name" id="name" required />
			</label>

			<label>
				<span>email*</span>
				<input type="email" name="email" id="email" required />
			</label>

			<label>
				<span>phone</span>
				<input type="tel" name="phone" id="phone" />
			</label>

			<label>
				<span>message*</span>
				<textarea name="message" id="message" required class="h-32"></textarea>
			</label>

			<div class="flex gap-4 items-center">

				<input type="hidden" name="subject" value="JoshKaye.ca Inquiry" />
				<input type="submit" value="Send Email" class="cursor-pointer" />
				
				<div id="form-result">Sending...</div>
			</div>

		</div>
	</form>

	<Type className="p-6 bg-red-100">
		<p>
			For web design and development services, job opportunities, or
			general information, feel free to use the contact form, email, or
			social media to get in touch with me.
		</p>

		<p>
			I am always open to discussing new projects or opportunities to be a
			part of!
		</p>

		<div class="grid gap-4 contact-info-grid">
			<img src="/icon/email.svg" alt="Email Icon" />
			<a href="mailto:jkaye@shaw.ca">jkaye@shaw.ca</a>

			<img src="/icon/location.svg" alt="Location Icon" />
			<span class="clr-secondary-5"> port coquitlam, bc</span>

			<img src="/icon/github.svg" alt="GitHub Icon" />
			<a href="https://github.com/kaye360" target="_blank">
				@kaye360
			</a>

			<img src="/icon/linkedin.svg" alt="LinkedIn Icon" />
			<a href="https://www.linkedin.com/in/josh-kaye-ca/" target="_blank">
				@josh-kaye-ca
			</a>

			<img src="/icon/instagram.svg" alt="Instagram Icon" />
			<a href="https://www.instagram.com/kaye.360/" target="_blank">
				@kaye.360
			</a>
		</div>
	</Type>
</section>


<style>

	label {
		display :grid;
		gap : 2;
	}

	input, textarea {
		background-color: skyblue;
		max-width: 50ch;
	}

	.contact-info-grid {
		grid-template-columns: 25px 1fr;
	}

</style>


<script>
const handleSubmit = (event: Event) => {
	event.preventDefault();

	const myForm: any = event.target
	const formData: any = new FormData(myForm)
	const formResult = document.querySelector('#form-result') as HTMLDivElement

	fetch("/", {
		method: "POST",
		headers: { "Content-Type": "application/x-www-form-urlencoded" },
		body: new URLSearchParams(formData).toString(),
	})
	.then( () => formResult.innerHTML = 'Email Sent!' )
	.catch( () => formResult.innerHTML = 
		'Something went wrony. Please try using another method instead.'
)}

const form = document.querySelector("form") as HTMLFormElement
form.addEventListener("submit", handleSubmit);

</script>